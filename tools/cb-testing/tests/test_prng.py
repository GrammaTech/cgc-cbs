#!/usr/bin/env python

"""
Tests for ansi_x931_aes128.PRNG

Copyright (C) 2015 - Brian Caswell <bmc@lungetech.com>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

"""

import unittest
import random
import sys

sys.path.append('./lib')
from ansi_x931_aes128 import PRNG


class PRNGTests(unittest.TestCase):
    def test_prng(self):
        expected = "648fa900fe421280d2e45d0c009d8ab24cb135890ed9ba675015cbb3cda9536270eb28ce1dd8f58d7a5bcfa3490cb8c3".decode('hex')
        i = PRNG('A' * 48)

        stream = ''
        while len(stream) < len(expected):
            size = random.randint(1, len(expected) - len(stream))
            result = i.get(size)
            self.assertEqual(len(result), size)
            stream += result

        self.assertEqual(len(stream), len(expected))
        self.assertEqual(stream, expected)

    def test_ansi_seeds(self):
        vectors = [
            ['800000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc593', '339cef70da546707b2944591890394a3'],
            ['c00000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc594', 'cc96309772e727e71baf70c361e626ae'],
            ['e00000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc595', '793b0b004ce8543b24d26bc76ef84c19'],
            ['f00000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc596', '00a6100f3ac3c0afc7194d75863bb97d'],
            ['f80000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc597', 'db6dcd4cdaffd704e4ac9ba46448771a'],
            ['fc0000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc598', '29bb29e1ca7effe2807c674628ae97ff'],
            ['fe0000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc599', '67290ea5d230e13e73e9223929078bd9'],
            ['ff0000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc59a', '00a4362875f0ff7e2e58c616ca22a961'],
            ['ff8000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc59b', '1c689c09f84beaa4785f7507ce99d909'],
            ['ffc000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc59c', '5c83858da3c8d53ebce32fa44764a2c9'],
            ['ffe000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc59d', '5e4f68f6d5beb7c7855518b34e2ba2f6'],
            ['fff000000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc59e', 'ed7fe3b42b8724ce68c070e61588d11a'],
            ['fff800000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc59f', 'ffa4846475cb9f83261f0a04fd11368e'],
            ['fffc00000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a0', '3125f56ce4c048a5b33803c8020c8e6c'],
            ['fffe00000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a1', '7cc527baa5b2b3add8e2198b326b8555'],
            ['ffff00000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a2', '95810f62aee87acce306b4fafe30831b'],
            ['ffff80000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a3', '69c8e966ee3edaa1f78022d65f23d21a'],
            ['ffffc0000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a4', '5b5a4b89f521b3ba43b2f1fb226da412'],
            ['ffffe0000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a5', '669763cdac9c776108bb0a3ac9e8717b'],
            ['fffff0000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a6', '7420dfd43c1e1cdde2e97edc02c1c88a'],
            ['fffff8000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a7', '0c1d2142b51720bdcff11ff41cb573cd'],
            ['fffffc000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a8', '05b089e217efe8a06f25d8226f7075f8'],
            ['fffffe000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5a9', '12f408b060a676019a430173e9236802'],
            ['ffffff000000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5aa', '84deccb0a2e30e1df4601f1eab0a5498'],
            ['ffffff800000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ab', '4af9217a6587bb66c72093f9fa52dfef'],
            ['ffffffc00000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ac', '6c552cd4e79b887c7f8a82a204bb5bc3'],
            ['ffffffe00000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ad', '835e991a3fef8a735574b3c8d6c18ee3'],
            ['fffffff00000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ae', '7d4a1bad6049ed9f6105b54081e0a47b'],
            ['fffffff80000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5af', 'e4b2e5fd7c6ae9c7009b358dbfbbc40e'],
            ['fffffffc0000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b0', '601ed99fa91b1ee1e7b12e1b55cbbf39'],
            ['fffffffe0000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b1', '8c9e1f94fe91b8bc3bf62ca875595199'],
            ['ffffffff0000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b2', 'bc7f2371d7ace178ec967d3fd85fab35'],
            ['ffffffff8000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b3', '9e909514330bc5898cb6ce6c3a72798b'],
            ['ffffffffc000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b4', '9e8d2e53ea2b457941a6344b01b9e623'],
            ['ffffffffe000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b5', '9fd7cf92c009bd7823aa4b098245fe07'],
            ['fffffffff000000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b6', 'f9d462b9fc073ef766623acc9e813d79'],
            ['fffffffff800000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b7', 'bc8b053176ef602eab420c4c71c94b7d'],
            ['fffffffffc00000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b8', 'd914ff8866033081be23c7a6357e88a1'],
            ['fffffffffe00000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5b9', '056d2d88ceccf5eb1e14f6950e4f98ca'],
            ['ffffffffff00000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ba', '580f8e925dcb03206a0832e3cf956d44'],
            ['ffffffffff80000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5bb', '1f6cb3420f701353b16464869fd9777b'],
            ['ffffffffffc0000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5bc', '003130793596f2b1e2d5bde2b48ae312'],
            ['ffffffffffe0000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5bd', '267b9b7ef90a732f836de5b95dc3c5ab'],
            ['fffffffffff0000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5be', 'f41155bee8af3ee58e9dae215f8cd565'],
            ['fffffffffff8000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5bf', 'e5eac38320ce55f8a2aa8ba80d2a1814'],
            ['fffffffffffc000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c0', '762d7889797c3de5cc043e7a523d4355'],
            ['fffffffffffe000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c1', '07eabc9d857245eb77703c4c8a37a07a'],
            ['ffffffffffff000000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c2', 'ee442d216c2bca9056f2841a302bc7db'],
            ['ffffffffffff800000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c3', '8c6d73bd41af6120d542e0b96262c090'],
            ['ffffffffffffc00000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c4', '6d6e205a2525666e46ae794096ff27e0'],
            ['ffffffffffffe00000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c5', 'eaf9559b192a779cd5381802a07be6e9'],
            ['fffffffffffff00000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c6', '8c611a402887c46010e3cd979708b225'],
            ['fffffffffffff80000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c7', 'a83310b018994cbc81c7bc021f4d4258'],
            ['fffffffffffffc0000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c8', '2bb0f59c40204ac4538b9857f90f89fb'],
            ['fffffffffffffe0000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5c9', '1fd58c060d2ac2a47a054d9e61cefe23'],
            ['ffffffffffffff0000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ca', '8c609188f847c46ae07212fb7f72b237'],
            ['ffffffffffffff8000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5cb', '9c8377288804e9c72487a23cca4f1847'],
            ['ffffffffffffffc000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5cc', '2ca0336293178a7b1e3eecb073722fd9'],
            ['ffffffffffffffe000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5cd', '522fa2d0681b68c0409f14a7bbc10f35'],
            ['fffffffffffffff000000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ce', '68bd7966a4b327ba5cd7454b71473441'],
            ['fffffffffffffff800000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5cf', '67b5ed9ccc8849e20ed1339cf527cf31'],
            ['fffffffffffffffc00000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d0', 'a58ea39069a3f84d5f5f30b3d42269f1'],
            ['fffffffffffffffe00000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d1', '11ee2c950e9b942d5a2d6bf9a0cce85c'],
            ['ffffffffffffffff00000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d2', 'a704ba2bd785a1d3f9e97f58e93d6a53'],
            ['ffffffffffffffff80000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d3', '473ff1fa63144c14a53f1a4a479593eb'],
            ['ffffffffffffffffc0000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d4', '8f680d904097fffd37e0872d18e20f2d'],
            ['ffffffffffffffffe0000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d5', 'b629d40bf2c60fc13bf0181af99fc166'],
            ['fffffffffffffffff0000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d6', '5175a49b094152dba016e36cf8831533'],
            ['fffffffffffffffff8000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d7', '451df25da209595f77c4cf2abcd54ece'],
            ['fffffffffffffffffc000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d8', '44895ad13ac1a007a834f39d53ccd9a9'],
            ['fffffffffffffffffe000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5d9', '4aefd749fd865514f99ef0aecdf7a129'],
            ['ffffffffffffffffff000000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5da', '6bd592cca825397cfc494d4a02313971'],
            ['ffffffffffffffffff800000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5db', '2c3fc41c6f87074446b1469ab8948431'],
            ['ffffffffffffffffffc00000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5dc', 'd9e8e216af859e9a510ae08f41739af1'],
            ['ffffffffffffffffffe00000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5dd', 'bb93adbcf7be88c3660ef9ae61c4f138'],
            ['fffffffffffffffffff00000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5de', '89cffce3438b952ce14a5a6242f6b25a'],
            ['fffffffffffffffffff80000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5df', 'd3b28657e39893514bf2afd387e444e9'],
            ['fffffffffffffffffffc0000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e0', 'fd2896cf0b953c003ba7f6ce609d914a'],
            ['fffffffffffffffffffe0000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e1', 'd2a8614e8f8eb1e84cc072c1696ee752'],
            ['ffffffffffffffffffff0000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e2', '015ed8675bfecb0615c15ee859b8e9c3'],
            ['ffffffffffffffffffff8000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e3', 'efa41e228d14c7cff1573b90b453620f'],
            ['ffffffffffffffffffffc000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e4', '669a55b7db37871ae198942ca4d6047c'],
            ['ffffffffffffffffffffe000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e5', '704ad73a8444d8dc2989c95e300e0797'],
            ['fffffffffffffffffffff000000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e6', '04846e9aaca38588cb532ae2a02223fb'],
            ['fffffffffffffffffffff800000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e7', '2d7f5a4e3fdcc7af8e00673cf150aa18'],
            ['fffffffffffffffffffffc00000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e8', 'f604a237f7f1625c18fe24fb3ada3869'],
            ['fffffffffffffffffffffe00000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5e9', 'a08dd841f9409a33791564bf6720d74f'],
            ['ffffffffffffffffffffff00000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ea', 'd1fbb90f90d345f15060218bc0494a4b'],
            ['ffffffffffffffffffffff80000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5eb', 'd220cd3746368818f891f7ac95dc0c87'],
            ['ffffffffffffffffffffffc0000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ec', '58ed87f98ecd9b1d0dd2bb0ab7f1ff82'],
            ['ffffffffffffffffffffffe0000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ed', '3b204ee96831eb733eba7384ad4f593c'],
            ['fffffffffffffffffffffff0000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ee', 'c025be20ab98e3a45fdd66bfedb695b4'],
            ['fffffffffffffffffffffff8000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ef', 'e9e476e82c07f885991597df073a0b9d'],
            ['fffffffffffffffffffffffc000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f0', 'c9769847c8d6c4bdf022e9264dab7162'],
            ['fffffffffffffffffffffffe000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f1', 'ac985a7f8d050fa7e6d738a55ceff66d'],
            ['ffffffffffffffffffffffff000000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f2', 'e4567a0da71d1d6ad87f77f78e6cc3f3'],
            ['ffffffffffffffffffffffff800000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f3', 'c27c560471664f4f76b30a081c539f44'],
            ['ffffffffffffffffffffffffc00000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f4', '43d68c5be6ffea3168278322b492f2be'],
            ['ffffffffffffffffffffffffe00000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f5', 'ca94792e82530aa192938bd5bc9b3921'],
            ['fffffffffffffffffffffffff00000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f6', '63b6d9ab7c6840ffe781fa74225f6f74'],
            ['fffffffffffffffffffffffff80000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f7', '046b14b747e5cb15c04f1c6042a8540c'],
            ['fffffffffffffffffffffffffc0000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f8', '0cca8944c609d8b94da06fccf362cd62'],
            ['fffffffffffffffffffffffffe0000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5f9', '48d2e16749f4629aa50d36e86505a62f'],
            ['ffffffffffffffffffffffffff0000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5fa', 'cde8d033e3c65ce2f342a8b00b575be7'],
            ['ffffffffffffffffffffffffff8000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5fb', '29628c81df38f4c64c76c7a18f25ed50'],
            ['ffffffffffffffffffffffffffc000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5fc', '58d1e32e8cd1653767014768f2b64b92'],
            ['ffffffffffffffffffffffffffe000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5fd', 'a7a0b9dddfde56be6fb2ca7a57bb6bca'],
            ['fffffffffffffffffffffffffff000007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5fe', '6e8efded58305528b83c086cfa1c00b8'],
            ['fffffffffffffffffffffffffff800007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc5ff', '8cd9ec6ab4f77088d737a4b88c819431'],
            ['fffffffffffffffffffffffffffc00007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc600', '22b8a64c9dd3f4f1966106a99bb51abf'],
            ['fffffffffffffffffffffffffffe00007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc601', 'fb327ac28841a17283b451a6c28090c8'],
            ['ffffffffffffffffffffffffffff00007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc602', 'b5284b41548d0774ac8cb2cacca6142c'],
            ['ffffffffffffffffffffffffffff80007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc603', 'de1a24deef977d23e837da08d80d41da'],
            ['ffffffffffffffffffffffffffffc0007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc604', '144824a70452915aeac6f3c51b1684fc'],
            ['ffffffffffffffffffffffffffffe0007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc605', '62076dd3bda3ad552cc849c768d8e454'],
            ['fffffffffffffffffffffffffffff0007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc606', '4d2b0a937c6db7c0754f45fb05ae1617'],
            ['fffffffffffffffffffffffffffff8007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc607', '18e1502a03f0b581bbdc325fab8dae89'],
            ['fffffffffffffffffffffffffffffc007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc608', '10499cbd013ba1b8ef09e17b9def52fb'],
            ['fffffffffffffffffffffffffffffe007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc609', '6589aa62b4e145ec9573428edc78256a'],
            ['ffffffffffffffffffffffffffffff007213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc60a', '7f3edb3044f72cd5de2599157e2b80de'],
            ['ffffffffffffffffffffffffffffff807213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc60b', '40b2071f7ade33926b4c702a294eb434'],
            ['ffffffffffffffffffffffffffffffc07213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc60c', '4a38a7c54858776d56e8289934fb6008'],
            ['ffffffffffffffffffffffffffffffe07213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc60d', '9a18a5c64ccba58ccbc535eb276afa41'],
            ['fffffffffffffffffffffffffffffff07213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc60e', 'cc225d6a3995b8e3e965055b61f2760b'],
            ['fffffffffffffffffffffffffffffff87213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc60f', '4e8ca55306c019332b8e3750d68bb78d'],
            ['fffffffffffffffffffffffffffffffc7213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc610', '23797319c2baeba81d4bd5e0d753469e'],
            ['fffffffffffffffffffffffffffffffe7213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc611', '1a261eb5776e0d4a8a7b5f0c892db74e'],
            ['ffffffffffffffffffffffffffffffff7213395b28586fe64026056638110b3c947529f603edb0cf6927f65edbbbc612', 'cb2eeb44945e9da22124e7868d69f55d'],
        ]
        for seed, want in vectors:
            seed = seed.decode('hex')
            want = want.decode('hex')
            prng = PRNG(seed)
            self.assertEquals(prng.get(len(want)), want)

    def test_mct_vector(self):
        seed = '35cc0ea481fc8a4f5f05c7d4667233b2' + 'f7d36762b9915f1ed585eb8e91700eb2' + '259e67249288597a4d61e7c0e690afae'
        seed = seed.decode('hex')

        mct_values = [
            ['259e67249288597a4d61e7c0e690afaf', '2d4e2614df15a079eb40ebaf43dcb415', '15f013af5a8e9df9a8e37500edaeac43'],
            ['259e67249288597a4d61e7c0e690afb0', '9e8af85973f52bc3ef4c7e987f4c375b', 'a9d74bb1c90a222adc398546d64879cf'],
            ['259e67249288597a4d61e7c0e690afb1', '6d4b33fc46bdd8de2d1342f1b91cfaab', '0379e404042d58180764fb9e6c5d94bb'],
            ['259e67249288597a4d61e7c0e690afb2', '6d62c73f1f1dbd118f4b8f6d0840ac7d', '3c74603e036d28c79947ffb56fee4e51'],
        ]

        result = ''
        prng = PRNG(seed)
        for i in range(10000):
            result = prng.get(16)
            if i < len(mct_values):
                expected_dt, expected_v, expected_result = mct_values[i]
                self.assertEquals(prng.DT, expected_dt.decode('hex'))
                self.assertEquals(prng.V, expected_v.decode('hex'))
                self.assertEquals(result, expected_result.decode('hex'))

        want = '26a6b3d33b8e7e68b75d9630ec036314'.decode('hex')

        self.assertEquals(prng.DT, '259e67249288597a4d61e7c0e690d6be'.decode('hex'))
        self.assertEquals(result, want)

if __name__ == '__main__':
    unittest.main()
